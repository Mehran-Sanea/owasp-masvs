# V2: الزامات حریم خصوصی و ذخیره سازی داده‌ها

## هدف کنترل

محافظت از داده‌های حساس، مانند اعتبار کاربر و اطلاعات خصوصی، یک تمرکز اساسی در امنیت موبایل است. در مرحله یک، اگر مکانیزم سیستم‌عامل مانند IPC به‌طور نادرست استفاده شود، داده‌های حساس می‌توانند ناخواسته در 1معرض برنامه‌های دیگر در حال اجرا در همان دستگاه باشند. همچنین ممکن است داده‌ها به‌طور ناخواسته به نشت ابر، پشتیبان گیری یا حافظه نهان صفحه‌کلید نشت کنند. علاوه بر این، دستگاه‌های تلفن همراه را می‌توان راحت‌تر در مقایسه با انواع دیگر دستگاه‌ها از بین برد یا سرقت کرد، بنابراین یک دشمن به دنبال دسترسی فیزیکی سناریویی محتمل است. در این حالت، محافظت‌های اضافی می‌تواند به‌کار گرفته شود تا بازیابی اطلاعات حساس دشوار شود.

توجه داشته باشید که، ازآنجاکه MASVS دارای محوریت برنامه است، خط‌مشی‌های سطح دستگاه مانند برنامه‌هایی که توسط راه‌حل‌های حل‌های MDM اعمال می‌شود را پوشش نمی‌دهد. ما استفاده از چنین سیاست‌هایی را در یک زمینه Enterprise برای تقویت بیشتر امنیت داده‌ها ترغیب می‌کنیم.

### تعریف داده‌های حساس

داده‌های حساس در استاندارد وارسی امنیت برنامه موبایل به اعتبارنامه(همانند نام کاربری و گذرواژه) کاربر و هر نوع داده‌ی حساس در این حوزه اتلاق می‌گردد، مانند:

- اطلاعات شناسایی شخصی که می‌توانند به دلیل سرقت هویت مورد سوءاستفاده قرار گیرند: شماره‌ تأمین اجتماعی، شماره کارت‌های اعتباری، شماره حساب‌های بانکی، اطلاعات درمانی افراد.
- داده‌های بسیار حساس که در صورت به خطر افتادن، منجر به ایجاد لطمه به اعتبار و هرینه های مالی خواهد شد: اطلاعات پیمانکاری، اطلاعات تحت پوشش توافق نامه‌های عدم افشای اطلاعات، اطلاعات مدیریتی.
- هر نوع داده‌ای که توسط قانون یا به دلایل انطباق با قوانین باید حفاظت شود.

## الزامات وارسی امنیت

بسیاری از پیامدهای ناشی از افشای اطلاعات را می‌توان با پیروی از قوانین ساده جلوگیری نمود. از این رو، رعایت بیشتر کنترل‌های ارائه شده در این فصل برای تمامی سطح‌های وارسی الزامی است.

| # | شناسه- آزمون امنیتی برنامه کاربردی موبایل | شرح | سطح یک | سطح دو |
| -- | -------- | ---------------------- | - | - |
| **2.1** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-1 | سامانه ذخیره سازی اعتبارنامه، امکان ذخیره سازی داده‌های حساس همانند اطلاعات شناسایی شخصی، اعتبارنامه کاربر یا کلیدهای رمزنگاری را تسهیل می‌نماید. | ✓ | ✓ |
| **2.2** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-2 | هیچ داده حساس نباید در خارج از ظرف برنامه یا امکانات ذخیره اطلاعات معتبر سیستم ذخیره شود. | ✓ | ✓ |
| **2.3** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-3 | هیچ اطلاعات حساسی در لاگ‌های برنامه نوشته نشده است. | ✓ | ✓ |
| **2.4** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-4 | هیچ داده‌های حساس با اشخاص ثالث به اشتراک گذاشته نمی‌شود مگر اینکه جزئی ضروری از معماری باشد. | ✓ | ✓ |
| **2.5** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-5 | حافظه نهان صفحه‌کلید در ورودی‌های متنی که داده‌های حساس را پردازش می‌کنند غیرفعال است. | ✓ | ✓ |
| **2.6** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-6 | هیچ داده‌ی حساسی از طرق ساز وکارهای Inter process communication (IPC) افشا نمی‌شود. | ✓ | ✓ |
| **2.7** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-7 | هیچ داده‌های حساس مانند گذرواژه یا پین از طریق رابط کاربری در معرض دید قرار نمی‌گیرند. | ✓ | ✓ |
| **2.8** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-8 | هیچ اطلاعات حساس در پشتیبان گیری‌های ایجادشده توسط سیستم‌عامل تلفن همراه درج نشده است. |   | ✓ |
| **2.9** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-9 | برنامه هنگام انتقال به پس‌زمینه داده‌های حساس را از منظره حذف می‌کند. |  | ✓ |
| **2.10** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-10 | این برنامه داده‌های حساس را بیش‌ازحد لازم در حافظه نگه نمی‌دارد، و حافظه به‌صراحت پس از استفاده پاک می‌شود. |  | ✓ |
| **2.11** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-11 | برنامه حداقل یک سیاست امنیتی برای دسترسی به دستگاه را اعمال می‌کند، مانند نیاز به کاربر برای تنظیم رمز عبور دستگاه. |  | ✓ |
| **2.12** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-12 | برنامه در مورد انواع اطلاعات شناسایی شخصی پردازش‌شده و همچنین بهترین اقدامات امنیتی که کاربر باید در استفاده از برنامه دنبال کند، به کاربر آموزش می‌دهد. |  | ✓ |
| **2.13** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-13 | هیچ داده حساس نباید به‌صورت محلی در دستگاه تلفن همراه ذخیره شود. در عوض، داده‌ها باید در صورت لزوم از یک نقطه پایانی از راه دور بازیابی شوند و فقط در حافظه نگهداری شوند. |  | ✓ |
| **2.14** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-14 | اگر داده‌های حساس هنوز هم نیاز به ذخیره محلی دارند، باید با استفاده از یک کلید مشتق شده از حافظه پشتیبانی‌شده سخت‌افزاری که نیاز به تأیید اعتبار دارد، رمزگذاری شود. |  | ✓ |
| **2.15** | آزمون امنیت برنامه کاربردی موبایل-ذخیره سازی-15 | فضای ذخیره‌سازی محلی برنامه باید بعد از تعداد زیادی از تلاش‌های تأیید صحت هویت، پاک شود. |  | ✓ |

## مراجع

راهنمای تست امنیت موبایل OWASP دستورالعمل‌های دقیقی را برای تأیید الزامات ذکرشده در این بخش ارائه می‌دهد.

- Android: آزمایش ذخیره‌سازی داده‌ها<https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md>
- iOS: آزمایش ذخیره‌سازی داده‌ها<https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md>

برای دریافت اطلاعات بیشتر به آدرس های زیر مراجعه نمایید:

- OWASP Mobile Top 10: M1 (استفاده نادرست از بسترهای نرم‌افزاری)<https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage>
- OWASP Mobile Top 10: M2 (ذخیره اطلاعات ناامن)<https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage>
- CWE 117 (خنثی‌سازی خروجی نامناسب برای لاگ‌های مربوط)<https://cwe.mitre.org/data/definitions/117.html>
- CWE 200 (قرار گرفتن در معرض اطلاعات)
<https://cwe.mitre.org/data/definitions/200.html>
- CWE 276 (مجوزهای پیش‌فرض نادرست)
<https://cwe.mitre.org/data/definitions/276.html>
- CWE 311 (رمزگذاری اطلاعات حساس ازدست‌رفته)<https://cwe.mitre.org/data/definitions/311.html>
- CWE 312 (ذخیره‌سازی اطلاعات حساس به‌صورت متن واضح)<https://cwe.mitre.org/data/definitions/312.html>
- CWE 316 (حافظه پاک‌سازی اطلاعات حساس در حافظه) <https://cwe.mitre.org/data/definitions/316.html>
- CWE 359 (قرار گرفتن در معرض اطلاعات خصوصی ("نقض حریم خصوصی"))<https://cwe.mitre.org/data/definitions/359.html>
- CWE 522 (اعتبار کافی محافظت نشده)<https://cwe.mitre.org/data/definitions/522.html>
- CWE 524 (قرار گرفتن در معرض اطلاعات از طریق ذخیره)<https://cwe.mitre.org/data/definitions/524.html>
- CWE 530 (قرار گرفتن پرونده تهیه نسخه پشتیبان در یک حوزه کنترل غیرمجاز)<https://cwe.mitre.org/data/definitions/530.html>
- CWE 532 (قرار گرفتن در معرض اطلاعات از طریق پرونده‌های لاگ)<https://cwe.mitre.org/data/definitions/532.html>
- CWE 534 (قرار گرفتن در معرض اطلاعات از طریق پرونده‌های ورود به اشکال‌زدایی)<https://cwe.mitre.org/data/definitions/534.html>
- CWE 634 (نقاط ضعف بر فرآیندهای سیستم)<https://cwe.mitre.org/data/definitions/634.html>
- CWE 798 (استفاده از اعتبارنامه کدگذاری شده)<https://cwe.mitre.org/data/definitions/798.html>
- CWE 921 (ذخیره‌سازی داده‌های حساس در مکانیسم بدون کنترل دسترسی)<https://cwe.mitre.org/data/definitions/921.html>
- CWE 922 (ذخیره ناامن اطلاعات حساس)<https://cwe.mitre.org/data/definitions/922.html>
