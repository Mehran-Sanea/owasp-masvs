# V5: الزامات ارتباطات شبکه

## هدف کنترل

هدف از کنترل‌های ذکرشده در این بخش، اطمینان از محرمانه بودن و یکپارچگی اطلاعات ردوبدل شده بین برنامۀ کاربردی موبایل و نقاط پایانی سرویس از راه دور است. حداقل یک برنامۀ کاربردی موبایل باید با استفاده از پروتکل TLS با تنظیمات مناسب، یک کانال رمزگذاری شده و ایمن را برای ارتباطات شبکه ایجاد کند. سطح ۲ اقدامات عمیق دفاعی دیگری مانند پین کردن SSL را نشان می‌دهد.

## نیازمندی های وارسی امنیتی

| # | شناسه- آزمون امنیتی برنامه کاربردی موبایل | شرح | سطح یک | سطح دو |
| -- | -------- | ---------------------- | - | - |
| **5.1** | آزمون امنیتی برنامه کاربردی موبایل- شبکه-1 | داده‌ها با استفاده از TLS در شبکه رمزگذاری می‌شوند. کانال امن به‌طور مداوم در سراسر برنامه استفاده می‌شود. | ✓ | ✓ |
| **5.2** | آزمون امنیت برنامۀ کاربردی موبایل-شبکه-2 | تنظیمات TLS مطابق با بهترین روش‌های فعلی است، یا در صورت امکان سیستم‌عامل تلفن همراه از استانداردهای پیشنهادی پشتیبانی نمی‌کند. | ✓ | ✓ |
| **5.3** | آزمون امنیت برنامۀ کاربردی موبایل-شبکه-3 | برنامه هنگام ایجاد کانال امن، گواهی X.509 را از نقطه انتهای راه دور تأیید می‌کند. فقط گواهینامه‌های امضاشده توسط یک CA قابل‌اعتماد پذیرفته می‌شوند. | ✓ | ✓ |
| **5.4** | آزمون امنیت برنامۀ کاربردی موبایل-شبکه-4 | برنامه یا از فروشگاه گواهینامه مخصوص خود استفاده می‌کند و یا گواهی انتهایی یا کلید عمومی را پین می‌کند و متعاقباً با نقاط پایانی که گواهی یا کلید دیگری ارائه می‌دهند، حتی اگر توسط یک مرکز معتبر امضاشده باشد، اتصالی برقرار نمی‌کند. |   | ✓ |
| **5.5** | آزمون امنیت برنامۀ کاربردی موبایل-شبکه-5 | برنامه برای انجام اقدامات حساس مانند ثبت‌نام و بازیابی حساب به یک کانال ارتباطی ناامن (ایمیل یا پیام کوتاه) تکیه ندارد. |  | ✓ |
| **5.6** | آزمون امنیت برنامۀ کاربردی موبایل-شبکه-6 | برنامه فقط به کتابخانه‌های اتصال و امنیت به‌روز بستگی دارد. |  | ✓ |

## مراجع

راهنمای تست امنیت موبایل OWASP دستورالعمل‌های دقیقی را برای تأیید الزامات ذکرشده در این بخش ارائه می‌دهد.

- راهنمای عمومی: آزمودن ارتباطات شبکه- 
<https://github.com/OWASP/owasp-mstg/blob/master/Document/0x04f-Testing-Network-Communication.md>
- Android: آزمودن ارتباطات شبکه - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05g-Testing-Network-Communication.md>
- iOS: آزمودن ارتباطات شبکه - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06g-Testing-Network-Communication.md>

برای دریافت اطلاعات بیشتر به آدرس های زیر مراجعه نمایید:

- ده تهدید برتر موبایل OWASP - تهدید رتبه سوم (ارتباطات ناامن) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication>
- CWE 295 (اعتبارسنجی نامناسب گواهی) - <https://cwe.mitre.org/data/definitions/295.html>
- CWE 296 (اعتبارسنجی نادرست زنجیره اعتماد یک گواهی‌نامه)-<https://cwe.mitre.org/data/definitions/296.html>
- CWE 297 (اعتبارسنجی نامناسب گواهی با عدم تطابق میزبان)-<https://cwe.mitre.org/data/definitions/297.html>
- CWE 298 (اعتبارسنجی نامناسب انقضا گواهینامه)-<https://cwe.mitre.org/data/definitions/298.html>
- CWE 308 (استفاده از احراز هویت تک عاملی) - <https://cwe.mitre.org/data/definitions/308.html>
- CWE 319 (انتقال اطلاعات حساس بصورت رمزنشده) - <https://cwe.mitre.org/data/definitions/319.html>
- CWE 326 (قدرت نامناسب رمزگذاری)<https://cwe.mitre.org/data/definitions/326.html>
- CWE 327 (استفاده از الگوریتم رمزنگاری‌شده شکسته یا خطرناک)<https://cwe.mitre.org/data/definitions/327.html>
- CWE 780 (استفاده از الگوریتم RSA بدون OAEP) - <https://cwe.mitre.org/data/definitions/780.html>
- CWE 940 (وارسی نادرست منبع یک کانال ارتباطی)-<https://cwe.mitre.org/data/definitions/940.html>
- CWE 941 (مقصد نادرست مشخص‌شده در یک کانال ارتباطی) - <https://cwe.mitre.org/data/definitions/941.html>
