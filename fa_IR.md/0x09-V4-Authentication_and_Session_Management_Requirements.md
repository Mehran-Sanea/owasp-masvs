# V4: الزامات احراز هویت و مدیریت نشست

## هدف کنترل

در بیشتر موارد، ورود کاربران به یک سرویس از راه دور، بخش جدایی‌ناپذیر از معماری کلی برنامۀ کاربردی موبایل است. در صورتی که بیشتر منطق برنامه در نقطه پایانی اتفاق بیفتد، استاندارد MASVS برخی الزامات اصلی را درباره ی نحوه مدیریت حساب‌های کاربران و نشست ها توصیف می‌کند.

## الزامات وارسی امنیتی

| # | شناسه-آزمون امنیت برنامۀ کاربردی موبایل | شرح | سطح یک | سطح دو |
| -- | -------- | ---------------------- | - | - |
| **4.1** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-1 | اگر برنامه کاربردی دسترسی کاربران را به یک سرویس راه دور فراهم کند، نوعی از احراز هویت همانند احراز هویت بر اساس نام کاربری یا گذرواژه، از راه دور انجام می‌شود. | ✓ | ✓ |
| **4.2** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-2 | در صورتی که از مدیریت نشست stateful استفاده می شود، نقطه پایانی از تولیدکننده تصادفی شناسه های نشست به منظور تصدیق درخواست کاربران بدون ارسال اعتبارنامه هایشان استفاده می نماید. | ✓ | ✓ |
| **4.3** | آزمون امنیت برنامۀ کاربردی موبایل-احراز اصالت-3 | اگر از روش احراز هویت مبتنی بر توکن stateless استفاده شود، سرویس دهنده توکنی را ایجاد می نماید که با الگوریتم امن امضا شده است | ✓ | ✓ |
| **4.4** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-4 | زمانی که کاربر از برنامه کاربردی خارج می‌شود، نقطه پایانی از راه دور نشست موجود را خاتمه می‌دهد. | ✓ | ✓ |
| **4.5** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-5 | یک خط‌مشی برای گذرواژه وجود دارد و در نقطه پایانی از راه دور اعمال می‌شود. | ✓ | ✓ |
| **4.6** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-6 | نقطه پایانی از راه دور، سازوکاری را به‌منظور حفاظت در برابر ثبت متعدد اعتبارنامه‌ها پیاده‌سازی می‌نماید. | ✓ | ✓ |
| **4.7** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-7 | در صورت عدم فعالیت کاربر پس از مدت زمان تعیین شده، نشست‌ها در نقطه پایانی نامعتبر می‌شوند و توکن دسترسی یا شناسه‌ی نشست منقضی می‌شود. | ✓ | ✓ |
| **4.8** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-8 | احراز هویت بیومتریک، در صورت وجود، محدود به واقعه نیست (یعنی با استفاده از رابط برنامه کاربردی که به‌سادگی مقدار کیفی"درست" یا "نادرست" را برمی‌گرداند) بلکه بر اساس keychain یا keystore است. | | ✓ |
| **4.9** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-9 | عامل دوم احرازهویت در نقطه پایانی از راه دور وجود دارد و الزام احراز هویت دو عاملی به طور مستمر اعمال می‌شود.  | | ✓ |
| **4.10** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-10 | تراکنش‌های دارای اطلاعات حساس نیاز به احراز هویت مجدد دارند. | | ✓ |
| **4.11** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-11 | برنامه کاربردی، کاربر را از تمامی فعالیت‌های حساس مرتبط با حساب کاربری خود آگاه می‌سازد. کاربران می‌تواند فهرست تمامی دستگاه‌ها، اطلاعات متنی (آدرس IP، محل و سایر اطلاعات) را مشاهده نماید و دستگاه‌های خاصی را مسدود کنند. | | ✓ |
| **4.12** | آزمون امنیت برنامۀ کاربردی موبایل-احراز هویت-12 | مدل‌های اعطای مجوز باید در نقطه پایانی از راه دور تعریف و اجرا شوند. | ✓ | ✓ |

## مراجع

راهنمای آزمون امنیت موبایل OWASP، دستورالعمل‌های دقیقی را به منظور وارسی الزامات ذکرشده در این بخش ارائه می‌دهد.

- راهنمای کلی: احراز هویت و مدیریت نشست - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x04e-Testing-Authentication-and-Session-Management.md>
- Android: آزمودن احراز هویت محلی - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05f-Testing-Local-Authentication.md>
- iOS: آزمودن احراز هویت محلی - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06f-Testing-Local-Authentication.md>

برای دریافت اطلاعات بیشتر به آدرس های زیر مراجعه نمایید:

- ده تهدید برتر موبایل OWASP - تهدید رتبه چهارم (احراز هویت ناامن) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication>
- ده تهدید برتر موبایل OWASP - تهدید رتبه ششم(صدور مجوز ناامن) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m6-insecure-authorization>
- CWE 287 (احراز هویت نامناسب) - <https://cwe.mitre.org/data/definitions/287.html>
- CWE 307 (اعمال محدودیت نامناسب در احراز هویت های متعدد) - <https://cwe.mitre.org/data/definitions/307.html>
- CWE 308 (استفاده از احراز هویت تک عاملی) - <https://cwe.mitre.org/data/definitions/308.html>
- CWE 521 (الزامات گذرواژه ضعیف) - <https://cwe.mitre.org/data/definitions/521.html>
- CWE 604 (استفاده از احراز هویت سمت کاربر) - <https://cwe.mitre.org/data/definitions/604.html>
- CWE 613 (خاتمه نامناسب نشست) - <https://cwe.mitre.org/data/definitions/613.html>
