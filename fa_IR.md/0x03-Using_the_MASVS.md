# استاندارد وارسی امنیت اپلیکیشن موبایل

از MASVS می‌توان برای ایجاد سطح اطمینان در امنیت برنامه‌های موبایل استفاده کرد. الزامات با رویکردهای زیر توسعه داده‌شده‌اند:

- استفاده به‌عنوان معیاری برای سنجش، به‌منظور تهیه استاندارد امنیتی برای مقایسه برنامه‌های موبایل موجود توسط صاحبان اپلیکیشن‌ها و توسعه‌دهندگان:
- استفاده به‌عنوان راهنمایی، برای ارائه راهنمایی در طول تمام مراحل توسعه و آزمایش برنامۀ موبایل؛
- استفاده در حین تهیه، برای ارائه یک مبنای اولیه برای وارسی امنیت برنامه موبایل.

## مدل AppSec موبایل

MASVS دو سطح وارسی امنیت (MASVS-L1 و MASVS-L2) و همچنین مجموعه‌ای از نیازهای انعطاف‌پذیر مهندسی معکوس را تعریف می‌کند (MASVS-R). MASVS-L1 شامل الزامات امنیتی عمومی است که برای همۀ برنامه‌های موبایل توصیه می‌شود، درحالی‌که MASVS-L2 باید برای برنامه‌هایی که داده‌های بسیار حساس را مدیریت می‌کنند، استفاده شود. MASVS-R موارد کنترلی دیگری را در برمی‌گیرد که در صورتی می‌تواند اعمال شود که جلوگیری از تهدیدهای طرف کاربر به عنوان هدف در طراحی مشخص شده باشد.

تحقق الزامات موجود در MASVS-L1 منجر به یک برنامه ایمن می‌شود که از بهترین روش‌های امنیتی پیروی کرده و از آسیب‌پذیری‌های رایج رنج نمی‌برد. MASVS-L2 کنترل‌های دیگری از نوع «دفاع در عمق» مانند SSL pinning را ارائه می‌دهد، نتیجه برنامه‌ای خواهد بود که در برابر حملات پیچیده‌تر مقاوم است - با این فرضیه که کنترل‌های امنیتی سیستم‌عامل موبایل دست‌نخورده است و کاربر نهایی به‌عنوان یک دشمن بالقوه مشاهده نمی‌شود. تحقق همه یا زیرمجموعه‌ای از الزامات محافظت از نرم‌افزار در MASVS-R به جلوگیری از تهدیدات خاص، جایی که کاربر نهایی مخرب است و یا سیستم‌عامل موبایل به خطر افتاده است، کمک می‌کند.

** الف: اگرچه پیاده‌سازی کنترل‌های MASVS-L1 را در هر برنامه‌ای توصیه می‌کنیم، پیاده‌سازی شدن یا نشدن آن نهایتاً باید یک تصمیم مبتنی بر ریسک باشد، که با صاحبان مشاغل گرفته می‌شود. **

** ب: توجه داشته باشید که کنترل‌های محافظت از نرم‌افزار ذکرشده در MASVS-R و شرح داده‌شده در راهنمای آزمون امنیت موبایل OWASP می‌توانند درنهایت دور زده شوند و هرگز نباید به‌عنوان جایگزینی برای کنترل‌های امنیتی مورداستفاده قرار گیرند. در عوض، آنها قصد دارند کنترل‌های مخصوص محافظت در برابر تهدید را به برنامه‌هایی اضافه کنند که پیش‌تر الزامات MASVS را در MASVS-L1 یا MASVS-L2 نیز برآورده کرده‌ند. **

<img src="images/masvs-levels-new.jpg" title="Verification Levels" width="600px" height="253px" />

### ساختار اسناد

بخش اول MASVS شامل توضیحی در مورد مدل امنیتی و سطوح وارسی موجود است و در ادامه توصیه‌هایی در مورد نحوۀ استفاده از استاندارد در عمل ارائه می‌شود. الزامات مفصل امنیتی، به همراه نقشه‌برداری از سطوح وارسی، در قسمت دوم فهرست شده است. الزامات بر اساس هدف فنی به هشت گروه (V1 تا V8) طبقه‌بندی شده‌اند. نام‌گذاری زیر در سراسر MASVS و MSTG استفاده می‌شود:

- *دسته‌بندی الزامات: * MASVS-Vx، به‌عنوان‌مثال MASVS-V2: ذخیره‌سازی داده و حریم خصوصی
- * الزام: * MASVS-Vx.y، به‌عنوان‌مثال MASVS-V2.2: "هیچ اطلاعات حساسی در لاگ‌های برنامه نوشته‌ نشده است."

### جزئیات سطوح وارسی

#### MASVS-L1: امنیت استاندارد

یک برنامه موبایل که MASVS-L1 را به‌دست می‌آورد به بهترین روش‌های امنیتی برنامه کاربردی موبایل پایبند است. این امر الزامات پایه در خصوص کیفیت کد، مدیریت داده‌های حساس و تعامل با محیط موبایل را برآورده می‌کند. برای تأیید کنترل‌های امنیتی باید یک فرایند آزمون انجام شود. این سطح برای همۀ برنامه‌های موبایل مناسب است.

#### MASVS-L2: دفاع در عمق

MASVS-L2 کنترل‌های امنیتی پیشرفته‌ای را ارائه می‌دهد که فراتر از الزامات استاندارد است. برای تحقق MASVS-L2، یک مدل تهدید باید وجود داشته باشد، و امنیت باید جزئی جدایی‌ناپذیر از معماری و طراحی برنامه باشد. بر اساس مدل تهدید، کنترل‌های مناسب MASVS-L2 باید با موفقیت انتخاب و اجرا می‌شدند. این سطح برای برنامه‌هایی مانند برنامه‌های بانکی موبایل که داده‌های بسیار حساس را مدیریت می‌کنند، مناسب است.

#### MASVS-R: مقاومت در برابر مهندسی معکوس و دستکاری

این نرم‌افزار دارای امنیت پیشرفته‌ای است و همچنین در برابر حملات خاص و کاملاً مشخص طرف کاربر مانند دستکاری، تعدیل یا مهندسی معکوس برای استخراج کد یا داده‌های حساس مقاوم است. چنین برنامه‌ای از ویژگی‌های امنیتی سخت‌افزار یا تکنیک‌های به‌اندازه کافی قوی و قابل‌اثبات محافظت از نرم‌افزار  استفاده می‌کند. MASVS-R برای برنامه‌هایی کاربرد دارد که داده‌های بسیار حساس را مدیریت می‌کنند و می‌توانند به‌عنوان ابزاری برای محافظت از مالکیت معنوی یا اثبات دستکاری برنامه استفاده کنند.

### توصیه می‌شود استفاده کنید

برنامه‌ها را می‌توان بر اساس ارزیابی ریسک قبلی و سطح کلی امنیت موردنیاز، در برابر MASVS L1 یا L2 تأیید کرد. L1 برای همه برنامه‌های موبایل قابل‌اجرا است، درحالی‌که L2 به طور کلی برای برنامه‌هایی که داده‌های حساس‌تر و یا عملکرد آنها را کنترل می‌کنند توصیه می‌شود. MASVS-R (یا بخش‌هایی از آن) را می‌توان برای اثبات مقاومت در برابر تهدیدات خاص، مانند بسته‌بندی مجدد یا استخراج داده‌های حساس، * علاوه بر این * در وارسی صحیح امنیتی استفاده کرد.

به‌طور خلاصه، انواع وارسی زیر موجود است:

- MASVS-L1
- MASVS-L1+R
- MASVS-L2
- MASVS-L2+R

ترکیب‌های مختلف منعکس‌کنندۀ درجه‌های مختلف امنیت و انعطاف‌پذیری است. هدف این است که امکان انعطاف‌پذیری فراهم شود: برای مثال، یک بازی موبایل ممکن است اضافه کردن کنترل‌های امنیتی MASVS-L2 مانند احراز هویت دو عاملی را به دلایل مربوط به کاربرد تضمین نکند، اما جلوگیری از دست‌کاری یک نیاز قوی تجاری محسوب شود.

#### انتخاب کدام نوع وارسی

اجرای الزامات MASVS L2 باعث افزایش امنیت می‌شود، درعین‌حال هزینه توسعه را افزایش می‌دهد و به‌طور بالقوه تجربه کاربر نهایی را بدتر می‌کند (تجارت کلاسیک). به‌طورکلی، L2 باید برای برنامه‌ها استفاده شود هر زمان که از دیدگاه ریسک در مقابل هزینه منطقی باشد (به‌عنوان مثال، جایی که ضرر بالقوه ناشی از سازش محرمانه یا یکپارچگی بالاتر از هزینه‌ای است که توسط کنترل‌های امنیتی اضافی ایجاد می‌شود). ارزیابی خطر باید اولین قدم قبل از استفاده از MASVS باشد.

##### مثال‌ها

###### MASVS-L1

- همه برنامه‌های تلفن همراه. MASVS-L1 بهترین روش‌های امنیتی را که می‌تواند با تأثیر معقول بر هزینه توسعه و تجربه کاربر دنبال شود، لیست کرده است. الزامات موجود در MASVS-L1 را برای هر برنامه‌ای که صلاحیت یکی از سطوح بالاتر را ندارد اعمال کنید.

<div style="page-break-after: always; visibility: hidden">
\pagebreak
</div>

###### MASVS-L2

- صنعت مراقبت‌های بهداشتی: برنامه‌های تلفن همراه که اطلاعات شناسایی شخصی را که می‌توانند برای سرقت هویت، پرداخت کلاه‌برداری یا انواع طرح‌های کلاه‌برداری مورداستفاده قرار گیرند، ذخیره می‌کنند. برای بخش مراقبت‌های بهداشتی ایالات‌متحده، ملاحظات پیروی از قانون حمل‌ونقل و پاسخگویی بیمه سلامت (HIPAA) رازداری، امنیت، قوانین اخطار نقض و قانون ایمنی بیمار است.

- صنعت مالی: برنامه‌هایی که دسترسی به اطلاعات بسیار حساس مانند شماره کارت‌های اعتباری، اطلاعات شخصی را امکان‌پذیر می‌سازند یا به کاربر اجازه می‌دهند وجوه را جابجا کند. این برنامه‌ها کنترل‌های امنیتی اضافی را برای جلوگیری از کلاه‌برداری تضمین می‌کنند. برنامه‌های مالی باید از مطابقت با استاندارد امنیت داده‌های کارت پرداخت (PCI DSS)، قانون گرام لیچ بیلی و قانون Sarbanes-Oxley (SOX) اطمینان حاصل کنند.

###### MASVS-L1+R

- برنامه‌های تلفن همراه که حفاظت از مالکیت معنوی (IP) یک هدف تجاری است. از کنترل‌های انعطاف‌پذیر ذکرشده در MASVS-R می‌توان برای افزایش تلاش موردنیاز برای به‌دست آوردن کد منبع اصلی و جلوگیری از دست‌کاری یا کرک شدن استفاده کرد.

- صنعت بازی: بازی‌هایی با نیاز اساسی برای جلوگیری از تعدیل و تقلب مانند بازی‌های آنلاین رقابتی. تقلب مسئله مهمی در بازی‌های آنلاین است، زیرا تعداد زیادی از متقلبان به یک پایه بازیکن ناراضی منجر می‌شوند و درنهایت می‌توانند باعث شکست یک بازی شوند. MASVS-R کنترل‌های اساسی ضد دست‌کاری را فراهم می‌کند تا به افزایش تلاش برای متقلبان کمک کند.

###### MASVS L2+R

- صنعت مالی: برنامه‌های بانکی آنلاین که به کاربر اجازه می‌دهد وجوه را جابجا کند، درجایی که تکنیک‌هایی از قبیل تزریق کد و ابزار دقیق در دستگاه‌های مصالحه خطر ایجاد می‌کند. در این‌حالت، از کنترل‌های MASVS-R می‌توان برای جلوگیری از دست‌کاری و بالا بردن نوار برای نویسندگان بدافزار استفاده کرد.

- همه برنامه‌های تلفن همراه که با طراحی نیاز به ذخیره داده‌های حساس در دستگاه همراه دارند و درعین‌حال باید از طیف گسترده‌ای از دستگاه‌ها و نسخه‌های سیستم‌عامل پشتیبانی کنند. در این حالت، از کنترل‌های انعطاف‌پذیری می‌توان به‌عنوان یک اقدام عمیق دفاعی برای افزایش تلاش برای مهاجمین باهدف استخراج داده‌های حساس استفاده کرد.

- برنامه‌هایی که دارای خریدهای درون برنامه هستند باید از ایده‌های جانبی سرور و MASVS-L2 برای محافظت از محتوای پرداخت‌شده استفاده کنند. اما ممکن است مواردی وجود داشته باشد که امکان استفاده از محافظت از سمت سرور وجود نداشته باشد. در آن موارد، کنترل‌های MASVS-R علاوه بر این باید به‌منظور افزایش تلاش معکوس یا دست‌کاری انجام شود
