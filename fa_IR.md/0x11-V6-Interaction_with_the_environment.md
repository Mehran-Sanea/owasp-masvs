# V6: الزامات تعامل با پلتفرم

## هدف کنترل

کنترل‌های موجود در این گروه اطمینان حاصل می‌کنند که برنامه از API های پلتفرم و اجزای استاندارد به روشی مطمئن استفاده می‌کند. علاوه بر این، کنترل‌ها ارتباط بین برنامه‌ها (IPC) را پوشش می‌دهند.

## نیازمندی های وارسی امنیتی

| # | شناسه- آزمون امنیتی برنامه کاربردی موبایل | شرح | سطح یک | سطح دو |
| -- | -------- | ---------------------- | - | - |
| **6.1** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-1 | برنامه فقط مجموعه‌ای از مجوزهای لازم را درخواست می‌کند. | ✓ | ✓ |
| **6.2** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-2 | کلیه ورودی‌های منابع خارجی و کاربر معتبر بوده و در صورت لزوم پاک‌سازی می‌شود. این شامل داده‌های دریافت شده از طریق UI، مکانیسم‌های IPC مانند اهداف، URL های سفارشی و منابع شبکه می‌شود.| ✓ | ✓ |
| **6.3** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-3 | برنامه عملکرد حساس را از طریق طرح‌های URL سفارشی صادر نمی‌کند، مگر اینکه این مکانیسم‌ها به‌درستی محافظت شوند. | ✓ | ✓ |
| **6.4** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-4 | این برنامه قابلیت‌های حساس را از طریق امکانات IPC صادر نمی‌کند، مگر اینکه این مکانیسم‌ها به‌درستی محافظت شوند. | ✓ | ✓ |
| **6.5** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-5 | جاوا اسکریپت در WebViews غیرفعال است مگر اینکه صریحاً لازم باشد.  | ✓ | ✓ |
| **6.6** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-6 | WebView ها پیکربندی‌شده‌اند تا فقط حداقل مجموعه‌ای از گیرنده‌های پروتکل موردنیاز را داشته باشند (در حالت ایده آل، فقط از https پشتیبانی می‌شود). گیرنده‌های بالقوه خطرناک، مانند پرونده، تلفن و شناسه برنامه، غیرفعال هستند. | ✓ | ✓ |
| **6.7** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-7 | اگر روش‌های بومی برنامه در معرض WebView قرار دارد، تأیید کنید که WebView فقط JavaScript موجود در بسته برنامه را ارائه می‌دهد.  | ✓ | ✓ |
| **6.8** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-8 | در صورت وجود هرگونه استفاده از API های سریال سازی ایمن، از بین بردن هدف استفاده می‌شود.  | ✓ | ✓ |
| **6.9** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-9 | برنامه از خود در برابر حملات پوشش روی صفحه محافظت می‌کند. (فقط Android) |  | ✓ |
| **6.10** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-10 | حافظه پنهان، ذخیره‌سازی و منابع بارگذاری شده در WebView (JavaScript و غیره) باید قبل از از بین رفتن WebView پاک شود. |  | ✓ |
| **6.11** | آزمون امنیت برنامۀ کاربردی موبایل-پلتفرم-11 | تأیید کنید که برنامه در هنگام ورود داده‌های حساس از استفاده از صفحه‌کلیدهای شخص ثالث جلوگیری می‌کند. | | ✓ |

## مراجع

راهنمای تست امنیت موبایل OWASP دستورالعمل‌های دقیقی را برای تأیید الزامات ذکرشده در این بخش ارائه می‌دهد.

- Android: آزمون تعامل پلتفرم - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05h-Testing-Platform-Interaction.md>
- iOS: آزمون تعامل پلتفرم - <https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06h-Testing-Platform-Interaction.md>

برای دریافت اطلاعات بیشتر به آدرس های زیر مراجعه نمایید:

- OWASP Mobile Top 10: M1 (استفاده نادرست از بسترهای نرم‌افزاری)<https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage>
- ده تهدید برتر موبایل OWASP - تهدید رتبه هفتم (کیفیت پایین کد) - <https://owasp.org/www-project-mobile-top-10/2016-risks/m7-client-code-quality>
- CWE 20 (اعتبارسنجی نامناسب ورودی برنامه کاربردی) - <https://cwe.mitre.org/data/definitions/20.html>
- CWE 79 (اعتبارسنجی نامناسب ورودی ها در زمان تولید صفحه وب) - <https://cwe.mitre.org/data/definitions/79.html>
- CWE 200 (افشا / نشت اطلاعات) - <https://cwe.mitre.org/data/definitions/200.html>
- CWE 250 (اجرای برنامه با امتیازات غیر ضروری) - <https://cwe.mitre.org/data/definitions/250.html>
- CWE 672 (عملیاتی بر روی منبع پس از انقضا یا انتشار) - <https://cwe.mitre.org/data/definitions/672.html>
- CWE 749 (وجود متد یا تابع خطرناک) - <https://cwe.mitre.org/data/definitions/749.html>
- CWE 772 (انتشار نسخه ازدست‌رفته پس از طول عمر مؤثر) - <https://cwe.mitre.org/data/definitions/772.html>
- CWE 920 (محدودیت نادرست در مصرف برق) - <https://cwe.mitre.org/data/definitions/920.html>
- CWE 925 (وارسی نامناسب هدف توسط گیرنده پخش) - <https://cwe.mitre.org/data/definitions/925.html>
- CWE 926 (صدور نامناسب اجزای برنامه Android) - <https://cwe.mitre.org/data/definitions/926.html>
- CWE 927 (استفاده از Intent ضمنی برای ارتباطات حساس)- <https://cwe.mitre.org/data/definitions/927.html>
- CWE 939 (مجوز نامناسب در کنترلر برای طرح URL سفارشی)- <https://cwe.mitre.org/data/definitions/939.html>
